996940c5b372437196c0490f6d307215
"use strict";
// test/integration/common/guards/auth.guard.integration.spec.ts
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const config_1 = require("@nestjs/config");
const axios_1 = require("@nestjs/axios");
const common_1 = require("@nestjs/common");
const rxjs_1 = require("rxjs");
const axios_2 = require("axios");
const ioredis_mock_1 = require("ioredis-mock");
const auth_guard_1 = require("../../../../src/common/guards/auth.guard");
const cache_service_1 = require("../../../../src/cache/cache.service");
describe('AuthGuard - Integration Tests', () => {
    let module;
    let authGuard;
    let configService;
    let cacheService;
    let httpService;
    let redisClient; // Fix: Utilisation du type correct
    // ============================================================================
    // HELPERS D'INTÉGRATION
    // ============================================================================
    const createMockExecutionContext = (request) => {
        return {
            switchToHttp: () => ({
                getRequest: () => request,
                getResponse: jest.fn(),
                getNext: jest.fn(),
            }),
            switchToRpc: jest.fn(),
            switchToWs: jest.fn(),
            getType: () => 'http',
            getClass: jest.fn(),
            getHandler: jest.fn(),
            getArgs: jest.fn(),
            getArgByIndex: jest.fn(),
        };
    };
    const createTestUser = () => ({
        id: 'integration-user-123',
        email: 'integration@example.com',
        roles: ['user'],
    });
    const createAuthResponse = (user) => ({
        data: {
            valid: true,
            user: {
                id: user.id,
                email: user.email,
                roles: user.roles,
            },
            expiresAt: new Date(Date.now() + 3600000).toISOString(),
        },
        status: 200,
        statusText: 'OK',
        headers: {},
        config: {},
    });
    const waitForCache = (ms = 50) => {
        return new Promise(resolve => setTimeout(resolve, ms));
    };
    // ============================================================================
    // SETUP ET TEARDOWN
    // ============================================================================
    beforeAll(async () => {
        // Setup Redis mock
        redisClient = new ioredis_mock_1.default({
            data: {},
            lazyConnect: false,
            enableOfflineQueue: true,
        });
        module = await testing_1.Test.createTestingModule({
            imports: [
                config_1.ConfigModule.forRoot({
                    isGlobal: true,
                    load: [
                        () => ({
                            AUTH_SERVICE_URL: 'http://localhost:3001',
                            AUTH_SERVICE_TIMEOUT: '5000',
                            AUTH_CACHE_TTL: '300',
                            REDIS_HOST: 'localhost',
                            REDIS_PORT: '6379',
                        }),
                    ],
                }),
                axios_1.HttpModule.register({
                    timeout: 5000,
                    maxRedirects: 0,
                }),
            ],
            providers: [
                auth_guard_1.AuthGuard,
                {
                    provide: cache_service_1.CacheService,
                    useFactory: () => {
                        const mockCacheService = {
                            redis: redisClient,
                            async get(key) {
                                return redisClient.get(key).then((value) => value ? JSON.parse(value) : null); // Fix: Type explicite pour value
                            },
                            async set(key, value, ttl) {
                                const serialized = JSON.stringify(value);
                                if (ttl) {
                                    return redisClient.setex(key, ttl, serialized);
                                }
                                return redisClient.set(key, serialized);
                            },
                            async del(key) {
                                return Array.isArray(key) ? redisClient.del(...key) : redisClient.del(key);
                            },
                        };
                        return mockCacheService;
                    },
                },
            ],
        }).compile();
        authGuard = module.get(auth_guard_1.AuthGuard);
        configService = module.get(config_1.ConfigService);
        cacheService = module.get(cache_service_1.CacheService);
        httpService = module.get(axios_1.HttpService);
    });
    afterAll(async () => {
        try {
            await redisClient.flushall();
            await redisClient.quit();
        }
        catch (error) {
            // Ignore Redis mock cleanup errors
        }
        await module.close();
    });
    beforeEach(async () => {
        // Clear cache before each test
        try {
            await redisClient.flushall();
        }
        catch (error) {
            // Ignore Redis mock connection errors
        }
        jest.clearAllMocks();
    });
    // ============================================================================
    // TESTS D'INTÉGRATION - FLUX COMPLET
    // ============================================================================
    describe('Complete Authentication Flow', () => {
        it('should perform complete cache miss -> auth service -> cache set flow', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.integration-test-token.signature';
            const user = createTestUser();
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            // Mock HTTP service response
            jest.spyOn(httpService, 'post').mockReturnValue((0, rxjs_1.of)(createAuthResponse(user)));
            // Act
            const result = await authGuard.canActivate(context);
            // Assert
            expect(result).toBe(true);
            expect(request.user).toEqual(user);
            // Verify cache was populated
            await waitForCache();
            const cacheKey = `auth:token:${require('crypto').createHash('sha256').update(token).digest('hex')}`;
            const cachedUser = await cacheService.get(cacheKey);
            expect(cachedUser).toEqual(user);
        });
        it('should perform complete cache hit flow without calling auth service', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.cached-token.signature';
            const user = createTestUser();
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            // Pre-populate cache
            const cacheKey = `auth:token:${require('crypto').createHash('sha256').update(token).digest('hex')}`;
            await cacheService.set(cacheKey, user, 300);
            // Mock HTTP service (should not be called)
            const httpSpy = jest.spyOn(httpService, 'post');
            // Act
            const result = await authGuard.canActivate(context);
            // Assert
            expect(result).toBe(true);
            expect(request.user).toEqual(user);
            expect(httpSpy).not.toHaveBeenCalled();
        });
        it('should handle cache failure and fallback to auth service', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.fallback-token.signature';
            const user = createTestUser();
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            // Simulate cache failure
            jest.spyOn(cacheService, 'get').mockRejectedValue(new Error('Redis connection lost'));
            jest.spyOn(httpService, 'post').mockReturnValue((0, rxjs_1.of)(createAuthResponse(user)));
            // Act
            const result = await authGuard.canActivate(context);
            // Assert
            expect(result).toBe(true);
            expect(request.user).toEqual(user);
            expect(httpService.post).toHaveBeenCalled();
        });
        it('should handle auth service failure with proper error propagation', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.invalid-token.signature';
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            // Mock auth service failure
            jest.spyOn(httpService, 'post').mockReturnValue((0, rxjs_1.throwError)(() => ({
                response: { status: 401 },
                message: 'Unauthorized'
            })));
            // Act & Assert
            await expect(authGuard.canActivate(context)).rejects.toThrow(common_1.UnauthorizedException);
            await expect(authGuard.canActivate(context)).rejects.toThrow('Invalid or expired token');
            // Verify no cache pollution
            const cacheKey = `auth:token:${require('crypto').createHash('sha256').update(token).digest('hex')}`;
            const cachedUser = await cacheService.get(cacheKey);
            expect(cachedUser).toBeNull();
        });
    });
    // ============================================================================
    // TESTS D'INTÉGRATION - CONFIGURATION RÉELLE
    // ============================================================================
    describe('Real Configuration Integration', () => {
        it('should use actual configuration values from ConfigService', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.config-test.signature';
            const user = createTestUser();
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            let capturedUrl = '';
            let capturedConfig = {};
            // Mock HTTP service to capture actual call
            jest.spyOn(httpService, 'post').mockImplementation((url, data, config) => {
                capturedUrl = url;
                capturedConfig = config;
                return (0, rxjs_1.of)(createAuthResponse(user));
            });
            // Act
            await authGuard.canActivate(context);
            // Assert
            expect(capturedUrl).toBe('http://localhost:3001/api/v1/auth/validate-token');
            expect(capturedConfig.timeout).toBe(5000);
            expect(capturedConfig.headers).toEqual({
                'Content-Type': 'application/json',
                'User-Agent': expect.stringMatching(/project-service/),
            });
        });
        it('should use configured cache TTL from ConfigService', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.ttl-test.signature';
            const user = createTestUser();
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            jest.spyOn(httpService, 'post').mockReturnValue((0, rxjs_1.of)(createAuthResponse(user)));
            // Act
            await authGuard.canActivate(context);
            // Assert - Check cache TTL
            await waitForCache();
            const cacheKey = `auth:token:${require('crypto').createHash('sha256').update(token).digest('hex')}`;
            const ttl = await redisClient.ttl(cacheKey);
            expect(ttl).toBeGreaterThan(250); // Should be close to 300 (5 minutes)
            expect(ttl).toBeLessThanOrEqual(300);
        });
        it('should handle missing configuration gracefully', async () => {
            // Arrange
            const originalGet = configService.get.bind(configService);
            jest.spyOn(configService, 'get').mockImplementation((key, defaultValue) => {
                if (key === 'AUTH_SERVICE_URL')
                    return undefined;
                return originalGet(key, defaultValue); // Fix: Appel direct avec bind
            });
            const token = 'eyJhbGciOiJIUzI1NiJ9.missing-config.signature';
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            // Act & Assert
            await expect(authGuard.canActivate(context)).rejects.toThrow();
        });
    });
    // ============================================================================
    // TESTS D'INTÉGRATION - CONCURRENCE RÉELLE
    // ============================================================================
    describe('Real Concurrency Integration', () => {
        it('should handle concurrent requests with real cache operations', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.concurrent-real.signature';
            const user = createTestUser();
            let authServiceCallCount = 0;
            jest.spyOn(httpService, 'post').mockImplementation(() => {
                authServiceCallCount++;
                // Simulate network delay with delayed Observable
                return (0, rxjs_1.of)(createAuthResponse(user)).pipe((0, rxjs_1.delay)(50));
            });
            // Act - 20 concurrent requests
            const promises = Array.from({ length: 20 }, async (_, i) => {
                const request = { headers: { authorization: `Bearer ${token}` } };
                const context = createMockExecutionContext(request);
                return authGuard.canActivate(context);
            });
            const results = await Promise.all(promises);
            // Assert
            expect(results.every(result => result === true)).toBe(true);
            // All requests should succeed even if auth service is called multiple times
            expect(authServiceCallCount).toBeGreaterThan(0);
            expect(authServiceCallCount).toBeLessThanOrEqual(20);
            // Verify cache contains the user
            await waitForCache(100);
            const cacheKey = `auth:token:${require('crypto').createHash('sha256').update(token).digest('hex')}`;
            const cachedUser = await cacheService.get(cacheKey);
            expect(cachedUser).toEqual(user);
        });
        it('should handle mixed cache hits and misses in concurrent scenario', async () => {
            // Arrange
            const users = Array.from({ length: 5 }, (_, i) => ({
                id: `concurrent-user-${i}`,
                email: `user${i}@example.com`,
                roles: ['user'],
            }));
            const tokens = users.map((_, i) => `eyJhbGciOiJIUzI1NiJ9.concurrent-${i}.signature`);
            // Pre-populate cache for first 3 users
            for (let i = 0; i < 3; i++) {
                const cacheKey = `auth:token:${require('crypto').createHash('sha256').update(tokens[i]).digest('hex')}`;
                await cacheService.set(cacheKey, users[i], 300);
            }
            // Mock auth service for cache misses
            jest.spyOn(httpService, 'post').mockImplementation(() => {
                return (0, rxjs_1.of)(createAuthResponse(users[0])); // Return any valid user
            });
            // Act - Concurrent requests with mix of cache hits and misses
            const promises = tokens.flatMap(token => Array.from({ length: 4 }, async () => {
                const request = { headers: { authorization: `Bearer ${token}` } };
                const context = createMockExecutionContext(request);
                return authGuard.canActivate(context);
            }));
            const results = await Promise.all(promises);
            // Assert
            expect(results.every(result => result === true)).toBe(true);
            expect(results).toHaveLength(20); // 5 tokens × 4 requests each
        });
    });
    // ============================================================================
    // TESTS D'INTÉGRATION - RÉSILIENCE RÉSEAU
    // ============================================================================
    describe('Network Resilience Integration', () => {
        it('should handle network timeouts with real HTTP client', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.timeout-test.signature';
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            // Mock a timeout error
            jest.spyOn(httpService, 'post').mockReturnValue((0, rxjs_1.throwError)(() => ({
                code: 'ECONNABORTED',
                message: 'timeout of 5000ms exceeded',
                name: 'Error',
            })));
            // Act & Assert
            await expect(authGuard.canActivate(context)).rejects.toThrow(common_1.InternalServerErrorException);
        });
        it('should handle network connection errors', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.connection-error.signature';
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            // Mock connection error
            jest.spyOn(httpService, 'post').mockReturnValue((0, rxjs_1.throwError)(() => ({
                code: 'ECONNREFUSED',
                message: 'connect ECONNREFUSED 127.0.0.1:3001',
                name: 'Error',
            })));
            // Act & Assert
            await expect(authGuard.canActivate(context)).rejects.toThrow(common_1.ServiceUnavailableException);
        });
        it('should handle DNS resolution errors', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.dns-error.signature';
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            // Mock DNS error
            jest.spyOn(httpService, 'post').mockReturnValue((0, rxjs_1.throwError)(() => ({
                code: 'ENOTFOUND',
                message: 'getaddrinfo ENOTFOUND non-existent-auth-service.local',
                name: 'Error',
            })));
            // Act & Assert
            await expect(authGuard.canActivate(context)).rejects.toThrow(common_1.ServiceUnavailableException);
        });
        it('should recover after network issues are resolved', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.recovery-test.signature';
            const user = createTestUser();
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            const httpSpy = jest.spyOn(httpService, 'post');
            // First call fails
            httpSpy.mockReturnValueOnce((0, rxjs_1.throwError)(() => new Error('Network error')));
            // Second call succeeds
            httpSpy.mockReturnValueOnce((0, rxjs_1.of)(createAuthResponse(user)));
            // Act - First call should fail
            await expect(authGuard.canActivate(context)).rejects.toThrow(common_1.InternalServerErrorException);
            // Second call should succeed
            const result = await authGuard.canActivate(context);
            // Assert
            expect(result).toBe(true);
            expect(request.user).toEqual(user);
        });
    });
    // ============================================================================
    // TESTS D'INTÉGRATION - CACHE REDIS RÉEL
    // ============================================================================
    describe('Real Redis Cache Integration', () => {
        it('should perform actual Redis operations for cache management', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.redis-test.signature';
            const user = createTestUser();
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            jest.spyOn(httpService, 'post').mockReturnValue((0, rxjs_1.of)(createAuthResponse(user)));
            // Act
            await authGuard.canActivate(context);
            // Assert - Verify Redis operations
            await waitForCache();
            const cacheKey = `auth:token:${require('crypto').createHash('sha256').update(token).digest('hex')}`;
            // Check direct Redis operations
            const exists = await redisClient.exists(cacheKey);
            expect(exists).toBe(1);
            const cachedValue = await redisClient.get(cacheKey);
            expect(cachedValue).not.toBeNull();
            expect(JSON.parse(cachedValue)).toEqual(user);
            const ttl = await redisClient.ttl(cacheKey);
            expect(ttl).toBeGreaterThan(0);
        });
        it('should handle Redis connection failures gracefully', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.redis-failure.signature';
            const user = createTestUser();
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            // Simulate Redis failure
            jest.spyOn(cacheService, 'get').mockRejectedValue(new Error('Redis connection failed'));
            jest.spyOn(cacheService, 'set').mockRejectedValue(new Error('Redis connection failed'));
            jest.spyOn(httpService, 'post').mockReturnValue((0, rxjs_1.of)(createAuthResponse(user)));
            // Act
            const result = await authGuard.canActivate(context);
            // Assert
            expect(result).toBe(true);
            expect(request.user).toEqual(user);
            // Should fallback to auth service when cache fails
            expect(httpService.post).toHaveBeenCalled();
        });
        it('should handle cache key collisions properly', async () => {
            // Arrange
            const token1 = 'eyJhbGciOiJIUzI1NiJ9.collision-test-1.signature';
            const token2 = 'eyJhbGciOiJIUzI1NiJ9.collision-test-2.signature';
            const user1 = { ...createTestUser(), id: 'user-1' };
            const user2 = { ...createTestUser(), id: 'user-2' };
            // Act - Cache both users
            jest.spyOn(httpService, 'post')
                .mockReturnValueOnce((0, rxjs_1.of)(createAuthResponse(user1)))
                .mockReturnValueOnce((0, rxjs_1.of)(createAuthResponse(user2)));
            const request1 = { headers: { authorization: `Bearer ${token1}` } };
            const context1 = createMockExecutionContext(request1);
            await authGuard.canActivate(context1);
            const request2 = { headers: { authorization: `Bearer ${token2}` } };
            const context2 = createMockExecutionContext(request2);
            await authGuard.canActivate(context2);
            // Assert - Verify both users are cached separately
            await waitForCache();
            const cacheKey1 = `auth:token:${require('crypto').createHash('sha256').update(token1).digest('hex')}`;
            const cacheKey2 = `auth:token:${require('crypto').createHash('sha256').update(token2).digest('hex')}`;
            expect(cacheKey1).not.toBe(cacheKey2);
            const cachedUser1 = await cacheService.get(cacheKey1);
            const cachedUser2 = await cacheService.get(cacheKey2);
            expect(cachedUser1).toEqual(user1);
            expect(cachedUser2).toEqual(user2);
        });
        it('should handle cache eviction and expiration correctly', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.expiration-test.signature';
            const user = createTestUser();
            // Set with very short TTL
            const cacheKey = `auth:token:${require('crypto').createHash('sha256').update(token).digest('hex')}`;
            await cacheService.set(cacheKey, user, 1); // 1 second TTL
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            // Act - First call should hit cache
            const result1 = await authGuard.canActivate(context);
            expect(result1).toBe(true);
            // Wait for expiration
            await new Promise(resolve => setTimeout(resolve, 1100));
            // Setup auth service for cache miss
            jest.spyOn(httpService, 'post').mockReturnValue((0, rxjs_1.of)(createAuthResponse(user)));
            // Second call should miss cache and hit auth service
            const result2 = await authGuard.canActivate(context);
            // Assert
            expect(result2).toBe(true);
            expect(httpService.post).toHaveBeenCalled();
        });
    });
    // ============================================================================
    // TESTS D'INTÉGRATION - MONITORING ET OBSERVABILITÉ
    // ============================================================================
    describe('Monitoring and Observability Integration', () => {
        it('should provide metrics for successful authentications', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.metrics-success.signature';
            const user = createTestUser();
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            jest.spyOn(httpService, 'post').mockReturnValue((0, rxjs_1.of)(createAuthResponse(user)));
            // Mock metrics collection
            const metricsCollected = [];
            const originalConsoleLog = console.log;
            console.log = (...args) => {
                if (args[0]?.includes && args[0].includes('AUTH_SUCCESS')) {
                    metricsCollected.push(args);
                }
                originalConsoleLog(...args);
            };
            try {
                // Act
                await authGuard.canActivate(context);
                // Assert
                // In a real implementation, you would verify metrics were sent to your monitoring system
                expect(request.user).toEqual(user);
            }
            finally {
                console.log = originalConsoleLog;
            }
        });
        it('should provide metrics for authentication failures', async () => {
            // Arrange
            const token = 'eyJhbGciOiJIUzI1NiJ9.metrics-failure.signature';
            const request = { headers: { authorization: `Bearer ${token}` } };
            const context = createMockExecutionContext(request);
            jest.spyOn(httpService, 'post').mockReturnValue((0, rxjs_1.throwError)(() => new axios_2.AxiosError('Unauthorized', '401')));
            // Mock metrics collection
            const metricsCollected = [];
            const originalConsoleError = console.error;
            console.error = (...args) => {
                if (args[0]?.includes && args[0].includes('AUTH_FAILURE')) {
                    metricsCollected.push(args);
                }
                originalConsoleError(...args);
            };
            try {
                // Act & Assert
                await expect(authGuard.canActivate(context)).rejects.toThrow(common_1.InternalServerErrorException);
            }
            finally {
                console.error = originalConsoleError;
            }
        });
        it('should track cache hit/miss ratios', async () => {
            // Arrange
            const baseToken = 'eyJhbGciOiJIUzI1NiJ9.cache-metrics';
            const user = createTestUser();
            // Pre-populate cache for some tokens
            const cachedTokens = Array.from({ length: 3 }, (_, i) => `${baseToken}-cached-${i}.signature`);
            const uncachedTokens = Array.from({ length: 7 }, (_, i) => `${baseToken}-uncached-${i}.signature`);
            for (const token of cachedTokens) {
                const cacheKey = `auth:token:${require('crypto').createHash('sha256').update(token).digest('hex')}`;
                await cacheService.set(cacheKey, user, 300);
            }
            jest.spyOn(httpService, 'post').mockReturnValue((0, rxjs_1.of)(createAuthResponse(user)));
            let cacheHits = 0;
            let cacheMisses = 0;
            // Act - Test cache hits
            for (const token of cachedTokens) {
                const request = { headers: { authorization: `Bearer ${token}` } };
                const context = createMockExecutionContext(request);
                await authGuard.canActivate(context);
                cacheHits++;
            }
            // Test cache misses
            for (const token of uncachedTokens) {
                const request = { headers: { authorization: `Bearer ${token}` } };
                const context = createMockExecutionContext(request);
                await authGuard.canActivate(context);
                cacheMisses++;
            }
            // Assert
            expect(cacheHits).toBe(3);
            expect(cacheMisses).toBe(7);
            expect(httpService.post).toHaveBeenCalledTimes(7); // Only cache misses call auth service
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL25pY29sYXNiZXJuYXJkL0Rlc2t0b3AvcHJvamVjdC1zZXJ2aWNlL3Rlc3QvaW50ZWdyYXRpb24vY29tbW9uL2d1YXJkcy9hdXRoLmd1YXJkLmludGVncmF0aW9uLnNwZWMudHMiLCJtYXBwaW5ncyI6IjtBQUFBLGdFQUFnRTs7QUFFaEUsNkNBQXNEO0FBQ3RELDJDQUE2RDtBQUM3RCx5Q0FBd0Q7QUFDeEQsMkNBQW9JO0FBQ3BJLCtCQUE2QztBQUM3QyxpQ0FBa0Q7QUFDbEQsK0NBQWlDO0FBRWpDLHlFQUFxRTtBQUNyRSx1RUFBbUU7QUFJbkUsUUFBUSxDQUFDLCtCQUErQixFQUFFLEdBQUcsRUFBRTtJQUM3QyxJQUFJLE1BQXFCLENBQUM7SUFDMUIsSUFBSSxTQUFvQixDQUFDO0lBQ3pCLElBQUksYUFBNEIsQ0FBQztJQUNqQyxJQUFJLFlBQTBCLENBQUM7SUFDL0IsSUFBSSxXQUF3QixDQUFDO0lBQzdCLElBQUksV0FBdUMsQ0FBQyxDQUFDLG1DQUFtQztJQUVoRiwrRUFBK0U7SUFDL0Usd0JBQXdCO0lBQ3hCLCtFQUErRTtJQUUvRSxNQUFNLDBCQUEwQixHQUFHLENBQUMsT0FBWSxFQUFvQixFQUFFO1FBQ3BFLE9BQU87WUFDTCxZQUFZLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztnQkFDbkIsVUFBVSxFQUFFLEdBQUcsRUFBRSxDQUFDLE9BQU87Z0JBQ3pCLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO2dCQUN0QixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTthQUNuQixDQUFDO1lBQ0YsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDdEIsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDckIsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLE1BQU07WUFDckIsUUFBUSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDbkIsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDckIsT0FBTyxFQUFFLElBQUksQ0FBQyxF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QUcsQ0FBQyxDQUFDO1lBRXBCLHdCQUF3QjtZQUN4QixLQUFLLE1BQU0sS0FBSyxJQUFJLFlBQVksRUFBRSxDQUFDO2dCQUNqQyxNQUFNLE9BQU8sR0FBRyxFQUFFLE9BQU8sRUFBRSxFQUFFLGFBQWEsRUFBRSxVQUFVLEtBQUssRUFBRSxFQUFFLEVBQUUsQ0FBQztnQkFDbEUsTUFBTSxPQUFPLEdBQUcsMEJBQTBCLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBQ3BELE1BQU0sU0FBUyxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQztnQkFDckMsU0FBUyxFQUFFLENBQUM7WUFDZCxDQUFDO1lBRUQsb0JBQW9CO1lBQ3BCLEtBQUssTUFBTSxLQUFLLElBQUksY0FBYyxFQUFFLENBQUM7Z0JBQ25DLE1BQU0sT0FBTyxHQUFHLEVBQUUsT0FBTyxFQUFFLEVBQUUsYUFBYSxFQUFFLFVBQVUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFDO2dCQUNsRSxNQUFNLE9BQU8sR0FBRywwQkFBMEIsQ0FBQyxPQUFPLENBQUMsQ0FBQztnQkFDcEQsTUFBTSxTQUFTLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDO2dCQUNyQyxXQUFXLEVBQUUsQ0FBQztZQUNoQixDQUFDO1lBRUQsU0FBUztZQUNULE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDMUIsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM1QixNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsc0NBQXNDO1FBQzNGLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvbmljb2xhc2Jlcm5hcmQvRGVza3RvcC9wcm9qZWN0LXNlcnZpY2UvdGVzdC9pbnRlZ3JhdGlvbi9jb21tb24vZ3VhcmRzL2F1dGguZ3VhcmQuaW50ZWdyYXRpb24uc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0ZXN0L2ludGVncmF0aW9uL2NvbW1vbi9ndWFyZHMvYXV0aC5ndWFyZC5pbnRlZ3JhdGlvbi5zcGVjLnRzXG5cbmltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xuaW1wb3J0IHsgQ29uZmlnTW9kdWxlLCBDb25maWdTZXJ2aWNlIH0gZnJvbSAnQG5lc3Rqcy9jb25maWcnO1xuaW1wb3J0IHsgSHR0cE1vZHVsZSwgSHR0cFNlcnZpY2UgfSBmcm9tICdAbmVzdGpzL2F4aW9zJztcbmltcG9ydCB7IEV4ZWN1dGlvbkNvbnRleHQsIFVuYXV0aG9yaXplZEV4Y2VwdGlvbiwgU2VydmljZVVuYXZhaWxhYmxlRXhjZXB0aW9uLCBJbnRlcm5hbFNlcnZlckVycm9yRXhjZXB0aW9uIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgb2YsIHRocm93RXJyb3IsIGRlbGF5IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBBeGlvc1Jlc3BvbnNlLCBBeGlvc0Vycm9yIH0gZnJvbSAnYXhpb3MnO1xuaW1wb3J0IFJlZGlzIGZyb20gJ2lvcmVkaXMtbW9jayc7XG5cbmltcG9ydCB7IEF1dGhHdWFyZCB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9jb21tb24vZ3VhcmRzL2F1dGguZ3VhcmQnO1xuaW1wb3J0IHsgQ2FjaGVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc3JjL2NhY2hlL2NhY2hlLnNlcnZpY2UnO1xuaW1wb3J0IHsgQ2FjaGVNb2R1bGUgfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvY2FjaGUvY2FjaGUubW9kdWxlJztcbmltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvY29tbW9uL2ludGVyZmFjZXMvdXNlci5pbnRlcmZhY2UnO1xuXG5kZXNjcmliZSgnQXV0aEd1YXJkIC0gSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7XG4gIGxldCBtb2R1bGU6IFRlc3RpbmdNb2R1bGU7XG4gIGxldCBhdXRoR3VhcmQ6IEF1dGhHdWFyZDtcbiAgbGV0IGNvbmZpZ1NlcnZpY2U6IENvbmZpZ1NlcnZpY2U7XG4gIGxldCBjYWNoZVNlcnZpY2U6IENhY2hlU2VydmljZTtcbiAgbGV0IGh0dHBTZXJ2aWNlOiBIdHRwU2VydmljZTtcbiAgbGV0IHJlZGlzQ2xpZW50OiBJbnN0YW5jZVR5cGU8dHlwZW9mIFJlZGlzPjsgLy8gRml4OiBVdGlsaXNhdGlvbiBkdSB0eXBlIGNvcnJlY3RcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIEhFTFBFUlMgRCdJTlTDiUdSQVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGNvbnN0IGNyZWF0ZU1vY2tFeGVjdXRpb25Db250ZXh0ID0gKHJlcXVlc3Q6IGFueSk6IEV4ZWN1dGlvbkNvbnRleHQgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICBzd2l0Y2hUb0h0dHA6ICgpID0+ICh7XG4gICAgICAgIGdldFJlcXVlc3Q6ICgpID0+IHJlcXVlc3QsXG4gICAgICAgIGdldFJlc3BvbnNlOiBqZXN0LmZuKCksXG4gICAgICAgIGdldE5leHQ6IGplc3QuZm4oKSxcbiAgICAgIH0pLFxuICAgICAgc3dpdGNoVG9ScGM6IGplc3QuZm4oKSxcbiAgICAgIHN3aXRjaFRvV3M6IGplc3QuZm4oKSxcbiAgICAgIGdldFR5cGU6ICgpID0+ICdodHRwJyxcbiAgICAgIGdldENsYXNzOiBqZXN0LmZuKCksXG4gICAgICBnZXRIYW5kbGVyOiBqZXN0LmZuKCksXG4gICAgICBnZXRBcmdzOiBqZXN0LmZuKCksXG4gICAgICBnZXRBcmdCeUluZGV4OiBqZXN0LmZuKCksXG4gICAgfSBhcyBFeGVjdXRpb25Db250ZXh0O1xuICB9O1xuXG4gIGNvbnN0IGNyZWF0ZVRlc3RVc2VyID0gKCk6IFVzZXIgPT4gKHtcbiAgICBpZDogJ2ludGVncmF0aW9uLXVzZXItMTIzJyxcbiAgICBlbWFpbDogJ2ludGVncmF0aW9uQGV4YW1wbGUuY29tJyxcbiAgICByb2xlczogWyd1c2VyJ10sXG4gIH0pO1xuXG4gIGNvbnN0IGNyZWF0ZUF1dGhSZXNwb25zZSA9ICh1c2VyOiBVc2VyKTogQXhpb3NSZXNwb25zZSA9PiAoe1xuICAgIGRhdGE6IHtcbiAgICAgIHZhbGlkOiB0cnVlLFxuICAgICAgdXNlcjoge1xuICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgIHJvbGVzOiB1c2VyLnJvbGVzLFxuICAgICAgfSxcbiAgICAgIGV4cGlyZXNBdDogbmV3IERhdGUoRGF0ZS5ub3coKSArIDM2MDAwMDApLnRvSVNPU3RyaW5nKCksXG4gICAgfSxcbiAgICBzdGF0dXM6IDIwMCxcbiAgICBzdGF0dXNUZXh0OiAnT0snLFxuICAgIGhlYWRlcnM6IHt9LFxuICAgIGNvbmZpZzoge30gYXMgYW55LFxuICB9KTtcblxuICBjb25zdCB3YWl0Rm9yQ2FjaGUgPSAobXM6IG51bWJlciA9IDUwKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xuICB9O1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gU0VUVVAgRVQgVEVBUkRPV05cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGJlZm9yZUFsbChhc3luYyAoKSA9PiB7XG4gICAgLy8gU2V0dXAgUmVkaXMgbW9ja1xuICAgIHJlZGlzQ2xpZW50ID0gbmV3IFJlZGlzKHtcbiAgICAgIGRhdGE6IHt9LFxuICAgICAgbGF6eUNvbm5lY3Q6IGZhbHNlLFxuICAgICAgZW5hYmxlT2ZmbGluZVF1ZXVlOiB0cnVlLFxuICAgIH0pO1xuXG4gICAgbW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgIGltcG9ydHM6IFtcbiAgICAgICAgQ29uZmlnTW9kdWxlLmZvclJvb3Qoe1xuICAgICAgICAgIGlzR2xvYmFsOiB0cnVlLFxuICAgICAgICAgIGxvYWQ6IFtcbiAgICAgICAgICAgICgpID0+ICh7XG4gICAgICAgICAgICAgIEFVVEhfU0VSVklDRV9VUkw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDEnLFxuICAgICAgICAgICAgICBBVVRIX1NFUlZJQ0VfVElNRU9VVDogJzUwMDAnLFxuICAgICAgICAgICAgICBBVVRIX0NBQ0hFX1RUTDogJzMwMCcsXG4gICAgICAgICAgICAgIFJFRElTX0hPU1Q6ICdsb2NhbGhvc3QnLFxuICAgICAgICAgICAgICBSRURJU19QT1JUOiAnNjM3OScsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICBdLFxuICAgICAgICB9KSxcbiAgICAgICAgSHR0cE1vZHVsZS5yZWdpc3Rlcih7XG4gICAgICAgICAgdGltZW91dDogNTAwMCxcbiAgICAgICAgICBtYXhSZWRpcmVjdHM6IDAsXG4gICAgICAgIH0pLFxuICAgICAgXSxcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICBBdXRoR3VhcmQsXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBDYWNoZVNlcnZpY2UsXG4gICAgICAgICAgdXNlRmFjdG9yeTogKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbW9ja0NhY2hlU2VydmljZSA9IHtcbiAgICAgICAgICAgICAgcmVkaXM6IHJlZGlzQ2xpZW50LFxuICAgICAgICAgICAgICBhc3luYyBnZXQoa2V5OiBzdHJpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVkaXNDbGllbnQuZ2V0KGtleSkudGhlbigodmFsdWU6IHN0cmluZyB8IG51bGwpID0+IHZhbHVlID8gSlNPTi5wYXJzZSh2YWx1ZSkgOiBudWxsKTsgLy8gRml4OiBUeXBlIGV4cGxpY2l0ZSBwb3VyIHZhbHVlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGFzeW5jIHNldChrZXk6IHN0cmluZywgdmFsdWU6IGFueSwgdHRsPzogbnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VyaWFsaXplZCA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAodHRsKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gcmVkaXNDbGllbnQuc2V0ZXgoa2V5LCB0dGwsIHNlcmlhbGl6ZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVkaXNDbGllbnQuc2V0KGtleSwgc2VyaWFsaXplZCk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGFzeW5jIGRlbChrZXk6IHN0cmluZyB8IHN0cmluZ1tdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoa2V5KSA/IHJlZGlzQ2xpZW50LmRlbCguLi5rZXkpIDogcmVkaXNDbGllbnQuZGVsKGtleSk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG1vY2tDYWNoZVNlcnZpY2U7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSkuY29tcGlsZSgpO1xuXG4gICAgYXV0aEd1YXJkID0gbW9kdWxlLmdldDxBdXRoR3VhcmQ+KEF1dGhHdWFyZCk7XG4gICAgY29uZmlnU2VydmljZSA9IG1vZHVsZS5nZXQ8Q29uZmlnU2VydmljZT4oQ29uZmlnU2VydmljZSk7XG4gICAgY2FjaGVTZXJ2aWNlID0gbW9kdWxlLmdldDxDYWNoZVNlcnZpY2U+KENhY2hlU2VydmljZSk7XG4gICAgaHR0cFNlcnZpY2UgPSBtb2R1bGUuZ2V0PEh0dHBTZXJ2aWNlPihIdHRwU2VydmljZSk7XG4gIH0pO1xuXG4gIGFmdGVyQWxsKGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgcmVkaXNDbGllbnQuZmx1c2hhbGwoKTtcbiAgICAgIGF3YWl0IHJlZGlzQ2xpZW50LnF1aXQoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gSWdub3JlIFJlZGlzIG1vY2sgY2xlYW51cCBlcnJvcnNcbiAgICB9XG4gICAgYXdhaXQgbW9kdWxlLmNsb3NlKCk7XG4gIH0pO1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIC8vIENsZWFyIGNhY2hlIGJlZm9yZSBlYWNoIHRlc3RcbiAgICB0cnkge1xuICAgICAgYXdhaXQgcmVkaXNDbGllbnQuZmx1c2hhbGwoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gSWdub3JlIFJlZGlzIG1vY2sgY29ubmVjdGlvbiBlcnJvcnNcbiAgICB9XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gVEVTVFMgRCdJTlTDiUdSQVRJT04gLSBGTFVYIENPTVBMRVRcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGRlc2NyaWJlKCdDb21wbGV0ZSBBdXRoZW50aWNhdGlvbiBGbG93JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcGVyZm9ybSBjb21wbGV0ZSBjYWNoZSBtaXNzIC0+IGF1dGggc2VydmljZSAtPiBjYWNoZSBzZXQgZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHRva2VuID0gJ2V5SmhiR2NpT2lKSVV6STFOaUo5LmludGVncmF0aW9uLXRlc3QtdG9rZW4uc2lnbmF0dXJlJztcbiAgICAgIGNvbnN0IHVzZXIgPSBjcmVhdGVUZXN0VXNlcigpO1xuICAgICAgY29uc3QgcmVxdWVzdCA9IHsgaGVhZGVyczogeyBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW59YCB9IH07XG4gICAgICBjb25zdCBjb250ZXh0ID0gY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQocmVxdWVzdCk7XG5cbiAgICAgIC8vIE1vY2sgSFRUUCBzZXJ2aWNlIHJlc3BvbnNlXG4gICAgICBqZXN0LnNweU9uKGh0dHBTZXJ2aWNlLCAncG9zdCcpLm1vY2tSZXR1cm5WYWx1ZShvZihjcmVhdGVBdXRoUmVzcG9uc2UodXNlcikpKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhdXRoR3VhcmQuY2FuQWN0aXZhdGUoY29udGV4dCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdCgocmVxdWVzdCBhcyBhbnkpLnVzZXIpLnRvRXF1YWwodXNlcik7XG5cbiAgICAgIC8vIFZlcmlmeSBjYWNoZSB3YXMgcG9wdWxhdGVkXG4gICAgICBhd2FpdCB3YWl0Rm9yQ2FjaGUoKTtcbiAgICAgIGNvbnN0IGNhY2hlS2V5ID0gYGF1dGg6dG9rZW46JHtyZXF1aXJlKCdjcnlwdG8nKS5jcmVhdGVIYXNoKCdzaGEyNTYnKS51cGRhdGUodG9rZW4pLmRpZ2VzdCgnaGV4Jyl9YDtcbiAgICAgIGNvbnN0IGNhY2hlZFVzZXIgPSBhd2FpdCBjYWNoZVNlcnZpY2UuZ2V0KGNhY2hlS2V5KTtcbiAgICAgIGV4cGVjdChjYWNoZWRVc2VyKS50b0VxdWFsKHVzZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwZXJmb3JtIGNvbXBsZXRlIGNhY2hlIGhpdCBmbG93IHdpdGhvdXQgY2FsbGluZyBhdXRoIHNlcnZpY2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB0b2tlbiA9ICdleUpoYkdjaU9pSklVekkxTmlKOS5jYWNoZWQtdG9rZW4uc2lnbmF0dXJlJztcbiAgICAgIGNvbnN0IHVzZXIgPSBjcmVhdGVUZXN0VXNlcigpO1xuICAgICAgY29uc3QgcmVxdWVzdCA9IHsgaGVhZGVyczogeyBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW59YCB9IH07XG4gICAgICBjb25zdCBjb250ZXh0ID0gY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQocmVxdWVzdCk7XG5cbiAgICAgIC8vIFByZS1wb3B1bGF0ZSBjYWNoZVxuICAgICAgY29uc3QgY2FjaGVLZXkgPSBgYXV0aDp0b2tlbjoke3JlcXVpcmUoJ2NyeXB0bycpLmNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZSh0b2tlbikuZGlnZXN0KCdoZXgnKX1gO1xuICAgICAgYXdhaXQgY2FjaGVTZXJ2aWNlLnNldChjYWNoZUtleSwgdXNlciwgMzAwKTtcblxuICAgICAgLy8gTW9jayBIVFRQIHNlcnZpY2UgKHNob3VsZCBub3QgYmUgY2FsbGVkKVxuICAgICAgY29uc3QgaHR0cFNweSA9IGplc3Quc3B5T24oaHR0cFNlcnZpY2UsICdwb3N0Jyk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXV0aEd1YXJkLmNhbkFjdGl2YXRlKGNvbnRleHQpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoKHJlcXVlc3QgYXMgYW55KS51c2VyKS50b0VxdWFsKHVzZXIpO1xuICAgICAgZXhwZWN0KGh0dHBTcHkpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjYWNoZSBmYWlsdXJlIGFuZCBmYWxsYmFjayB0byBhdXRoIHNlcnZpY2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB0b2tlbiA9ICdleUpoYkdjaU9pSklVekkxTmlKOS5mYWxsYmFjay10b2tlbi5zaWduYXR1cmUnO1xuICAgICAgY29uc3QgdXNlciA9IGNyZWF0ZVRlc3RVc2VyKCk7XG4gICAgICBjb25zdCByZXF1ZXN0ID0geyBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbn1gIH0gfTtcbiAgICAgIGNvbnN0IGNvbnRleHQgPSBjcmVhdGVNb2NrRXhlY3V0aW9uQ29udGV4dChyZXF1ZXN0KTtcblxuICAgICAgLy8gU2ltdWxhdGUgY2FjaGUgZmFpbHVyZVxuICAgICAgamVzdC5zcHlPbihjYWNoZVNlcnZpY2UsICdnZXQnKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1JlZGlzIGNvbm5lY3Rpb24gbG9zdCcpKTtcbiAgICAgIGplc3Quc3B5T24oaHR0cFNlcnZpY2UsICdwb3N0JykubW9ja1JldHVyblZhbHVlKG9mKGNyZWF0ZUF1dGhSZXNwb25zZSh1c2VyKSkpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGF1dGhHdWFyZC5jYW5BY3RpdmF0ZShjb250ZXh0KTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KChyZXF1ZXN0IGFzIGFueSkudXNlcikudG9FcXVhbCh1c2VyKTtcbiAgICAgIGV4cGVjdChodHRwU2VydmljZS5wb3N0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhdXRoIHNlcnZpY2UgZmFpbHVyZSB3aXRoIHByb3BlciBlcnJvciBwcm9wYWdhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHRva2VuID0gJ2V5SmhiR2NpT2lKSVV6STFOaUo5LmludmFsaWQtdG9rZW4uc2lnbmF0dXJlJztcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB7IGhlYWRlcnM6IHsgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWAgfSB9O1xuICAgICAgY29uc3QgY29udGV4dCA9IGNyZWF0ZU1vY2tFeGVjdXRpb25Db250ZXh0KHJlcXVlc3QpO1xuXG4gICAgICAvLyBNb2NrIGF1dGggc2VydmljZSBmYWlsdXJlXG4gICAgICBqZXN0LnNweU9uKGh0dHBTZXJ2aWNlLCAncG9zdCcpLm1vY2tSZXR1cm5WYWx1ZShcbiAgICAgICAgdGhyb3dFcnJvcigoKSA9PiAoe1xuICAgICAgICAgIHJlc3BvbnNlOiB7IHN0YXR1czogNDAxIH0sXG4gICAgICAgICAgbWVzc2FnZTogJ1VuYXV0aG9yaXplZCdcbiAgICAgICAgfSkpXG4gICAgICApO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChhdXRoR3VhcmQuY2FuQWN0aXZhdGUoY29udGV4dCkpLnJlamVjdHMudG9UaHJvdyhVbmF1dGhvcml6ZWRFeGNlcHRpb24pO1xuICAgICAgYXdhaXQgZXhwZWN0KGF1dGhHdWFyZC5jYW5BY3RpdmF0ZShjb250ZXh0KSkucmVqZWN0cy50b1Rocm93KCdJbnZhbGlkIG9yIGV4cGlyZWQgdG9rZW4nKTtcblxuICAgICAgLy8gVmVyaWZ5IG5vIGNhY2hlIHBvbGx1dGlvblxuICAgICAgY29uc3QgY2FjaGVLZXkgPSBgYXV0aDp0b2tlbjoke3JlcXVpcmUoJ2NyeXB0bycpLmNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZSh0b2tlbikuZGlnZXN0KCdoZXgnKX1gO1xuICAgICAgY29uc3QgY2FjaGVkVXNlciA9IGF3YWl0IGNhY2hlU2VydmljZS5nZXQoY2FjaGVLZXkpO1xuICAgICAgZXhwZWN0KGNhY2hlZFVzZXIpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gVEVTVFMgRCdJTlTDiUdSQVRJT04gLSBDT05GSUdVUkFUSU9OIFLDiUVMTEVcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGRlc2NyaWJlKCdSZWFsIENvbmZpZ3VyYXRpb24gSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB1c2UgYWN0dWFsIGNvbmZpZ3VyYXRpb24gdmFsdWVzIGZyb20gQ29uZmlnU2VydmljZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHRva2VuID0gJ2V5SmhiR2NpT2lKSVV6STFOaUo5LmNvbmZpZy10ZXN0LnNpZ25hdHVyZSc7XG4gICAgICBjb25zdCB1c2VyID0gY3JlYXRlVGVzdFVzZXIoKTtcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB7IGhlYWRlcnM6IHsgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWAgfSB9O1xuICAgICAgY29uc3QgY29udGV4dCA9IGNyZWF0ZU1vY2tFeGVjdXRpb25Db250ZXh0KHJlcXVlc3QpO1xuXG4gICAgICBsZXQgY2FwdHVyZWRVcmw6IHN0cmluZyA9ICcnO1xuICAgICAgbGV0IGNhcHR1cmVkQ29uZmlnOiBhbnkgPSB7fTtcblxuICAgICAgLy8gTW9jayBIVFRQIHNlcnZpY2UgdG8gY2FwdHVyZSBhY3R1YWwgY2FsbFxuICAgICAgamVzdC5zcHlPbihodHRwU2VydmljZSwgJ3Bvc3QnKS5tb2NrSW1wbGVtZW50YXRpb24oKHVybCwgZGF0YSwgY29uZmlnKSA9PiB7XG4gICAgICAgIGNhcHR1cmVkVXJsID0gdXJsO1xuICAgICAgICBjYXB0dXJlZENvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgcmV0dXJuIG9mKGNyZWF0ZUF1dGhSZXNwb25zZSh1c2VyKSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBhdXRoR3VhcmQuY2FuQWN0aXZhdGUoY29udGV4dCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KGNhcHR1cmVkVXJsKS50b0JlKCdodHRwOi8vbG9jYWxob3N0OjMwMDEvYXBpL3YxL2F1dGgvdmFsaWRhdGUtdG9rZW4nKTtcbiAgICAgIGV4cGVjdChjYXB0dXJlZENvbmZpZy50aW1lb3V0KS50b0JlKDUwMDApO1xuICAgICAgZXhwZWN0KGNhcHR1cmVkQ29uZmlnLmhlYWRlcnMpLnRvRXF1YWwoe1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnVXNlci1BZ2VudCc6IGV4cGVjdC5zdHJpbmdNYXRjaGluZygvcHJvamVjdC1zZXJ2aWNlLyksXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXNlIGNvbmZpZ3VyZWQgY2FjaGUgVFRMIGZyb20gQ29uZmlnU2VydmljZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHRva2VuID0gJ2V5SmhiR2NpT2lKSVV6STFOaUo5LnR0bC10ZXN0LnNpZ25hdHVyZSc7XG4gICAgICBjb25zdCB1c2VyID0gY3JlYXRlVGVzdFVzZXIoKTtcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB7IGhlYWRlcnM6IHsgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWAgfSB9O1xuICAgICAgY29uc3QgY29udGV4dCA9IGNyZWF0ZU1vY2tFeGVjdXRpb25Db250ZXh0KHJlcXVlc3QpO1xuXG4gICAgICBqZXN0LnNweU9uKGh0dHBTZXJ2aWNlLCAncG9zdCcpLm1vY2tSZXR1cm5WYWx1ZShvZihjcmVhdGVBdXRoUmVzcG9uc2UodXNlcikpKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBhdXRoR3VhcmQuY2FuQWN0aXZhdGUoY29udGV4dCk7XG5cbiAgICAgIC8vIEFzc2VydCAtIENoZWNrIGNhY2hlIFRUTFxuICAgICAgYXdhaXQgd2FpdEZvckNhY2hlKCk7XG4gICAgICBjb25zdCBjYWNoZUtleSA9IGBhdXRoOnRva2VuOiR7cmVxdWlyZSgnY3J5cHRvJykuY3JlYXRlSGFzaCgnc2hhMjU2JykudXBkYXRlKHRva2VuKS5kaWdlc3QoJ2hleCcpfWA7XG4gICAgICBjb25zdCB0dGwgPSBhd2FpdCByZWRpc0NsaWVudC50dGwoY2FjaGVLZXkpO1xuICAgICAgZXhwZWN0KHR0bCkudG9CZUdyZWF0ZXJUaGFuKDI1MCk7IC8vIFNob3VsZCBiZSBjbG9zZSB0byAzMDAgKDUgbWludXRlcylcbiAgICAgIGV4cGVjdCh0dGwpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMzAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgY29uZmlndXJhdGlvbiBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3Qgb3JpZ2luYWxHZXQgPSBjb25maWdTZXJ2aWNlLmdldC5iaW5kKGNvbmZpZ1NlcnZpY2UpO1xuICAgICAgamVzdC5zcHlPbihjb25maWdTZXJ2aWNlLCAnZ2V0JykubW9ja0ltcGxlbWVudGF0aW9uKChrZXk6IHN0cmluZywgZGVmYXVsdFZhbHVlPzogYW55KSA9PiB7IC8vIEZpeDogQWpvdXQgZHUgcGFyYW3DqHRyZSBkZWZhdWx0VmFsdWVcbiAgICAgICAgaWYgKGtleSA9PT0gJ0FVVEhfU0VSVklDRV9VUkwnKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gb3JpZ2luYWxHZXQoa2V5LCBkZWZhdWx0VmFsdWUpOyAvLyBGaXg6IEFwcGVsIGRpcmVjdCBhdmVjIGJpbmRcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB0b2tlbiA9ICdleUpoYkdjaU9pSklVekkxTmlKOS5taXNzaW5nLWNvbmZpZy5zaWduYXR1cmUnO1xuICAgICAgY29uc3QgcmVxdWVzdCA9IHsgaGVhZGVyczogeyBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW59YCB9IH07XG4gICAgICBjb25zdCBjb250ZXh0ID0gY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQocmVxdWVzdCk7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGF1dGhHdWFyZC5jYW5BY3RpdmF0ZShjb250ZXh0KSkucmVqZWN0cy50b1Rocm93KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gVEVTVFMgRCdJTlTDiUdSQVRJT04gLSBDT05DVVJSRU5DRSBSw4lFTExFXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBkZXNjcmliZSgnUmVhbCBDb25jdXJyZW5jeSBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb25jdXJyZW50IHJlcXVlc3RzIHdpdGggcmVhbCBjYWNoZSBvcGVyYXRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdG9rZW4gPSAnZXlKaGJHY2lPaUpJVXpJMU5pSjkuY29uY3VycmVudC1yZWFsLnNpZ25hdHVyZSc7XG4gICAgICBjb25zdCB1c2VyID0gY3JlYXRlVGVzdFVzZXIoKTtcblxuICAgICAgbGV0IGF1dGhTZXJ2aWNlQ2FsbENvdW50ID0gMDtcbiAgICAgIGplc3Quc3B5T24oaHR0cFNlcnZpY2UsICdwb3N0JykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgICAgYXV0aFNlcnZpY2VDYWxsQ291bnQrKztcbiAgICAgICAgLy8gU2ltdWxhdGUgbmV0d29yayBkZWxheSB3aXRoIGRlbGF5ZWQgT2JzZXJ2YWJsZVxuICAgICAgICByZXR1cm4gb2YoY3JlYXRlQXV0aFJlc3BvbnNlKHVzZXIpKS5waXBlKFxuICAgICAgICAgIGRlbGF5KDUwKVxuICAgICAgICApO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEFjdCAtIDIwIGNvbmN1cnJlbnQgcmVxdWVzdHNcbiAgICAgIGNvbnN0IHByb21pc2VzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogMjAgfSwgYXN5bmMgKF8sIGkpID0+IHtcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IHsgaGVhZGVyczogeyBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW59YCB9IH07XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBjcmVhdGVNb2NrRXhlY3V0aW9uQ29udGV4dChyZXF1ZXN0KTtcbiAgICAgICAgcmV0dXJuIGF1dGhHdWFyZC5jYW5BY3RpdmF0ZShjb250ZXh0KTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHRzLmV2ZXJ5KHJlc3VsdCA9PiByZXN1bHQgPT09IHRydWUpKS50b0JlKHRydWUpO1xuICAgICAgXG4gICAgICAvLyBBbGwgcmVxdWVzdHMgc2hvdWxkIHN1Y2NlZWQgZXZlbiBpZiBhdXRoIHNlcnZpY2UgaXMgY2FsbGVkIG11bHRpcGxlIHRpbWVzXG4gICAgICBleHBlY3QoYXV0aFNlcnZpY2VDYWxsQ291bnQpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIGV4cGVjdChhdXRoU2VydmljZUNhbGxDb3VudCkudG9CZUxlc3NUaGFuT3JFcXVhbCgyMCk7XG5cbiAgICAgIC8vIFZlcmlmeSBjYWNoZSBjb250YWlucyB0aGUgdXNlclxuICAgICAgYXdhaXQgd2FpdEZvckNhY2hlKDEwMCk7XG4gICAgICBjb25zdCBjYWNoZUtleSA9IGBhdXRoOnRva2VuOiR7cmVxdWlyZSgnY3J5cHRvJykuY3JlYXRlSGFzaCgnc2hhMjU2JykudXBkYXRlKHRva2VuKS5kaWdlc3QoJ2hleCcpfWA7XG4gICAgICBjb25zdCBjYWNoZWRVc2VyID0gYXdhaXQgY2FjaGVTZXJ2aWNlLmdldChjYWNoZUtleSk7XG4gICAgICBleHBlY3QoY2FjaGVkVXNlcikudG9FcXVhbCh1c2VyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1peGVkIGNhY2hlIGhpdHMgYW5kIG1pc3NlcyBpbiBjb25jdXJyZW50IHNjZW5hcmlvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdXNlcnMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiA1IH0sIChfLCBpKSA9PiAoe1xuICAgICAgICBpZDogYGNvbmN1cnJlbnQtdXNlci0ke2l9YCxcbiAgICAgICAgZW1haWw6IGB1c2VyJHtpfUBleGFtcGxlLmNvbWAsXG4gICAgICAgIHJvbGVzOiBbJ3VzZXInXSxcbiAgICAgIH0pKTtcblxuICAgICAgY29uc3QgdG9rZW5zID0gdXNlcnMubWFwKChfLCBpKSA9PiBgZXlKaGJHY2lPaUpJVXpJMU5pSjkuY29uY3VycmVudC0ke2l9LnNpZ25hdHVyZWApO1xuXG4gICAgICAvLyBQcmUtcG9wdWxhdGUgY2FjaGUgZm9yIGZpcnN0IDMgdXNlcnNcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMzsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGNhY2hlS2V5ID0gYGF1dGg6dG9rZW46JHtyZXF1aXJlKCdjcnlwdG8nKS5jcmVhdGVIYXNoKCdzaGEyNTYnKS51cGRhdGUodG9rZW5zW2ldKS5kaWdlc3QoJ2hleCcpfWA7XG4gICAgICAgIGF3YWl0IGNhY2hlU2VydmljZS5zZXQoY2FjaGVLZXksIHVzZXJzW2ldLCAzMDApO1xuICAgICAgfVxuXG4gICAgICAvLyBNb2NrIGF1dGggc2VydmljZSBmb3IgY2FjaGUgbWlzc2VzXG4gICAgICBqZXN0LnNweU9uKGh0dHBTZXJ2aWNlLCAncG9zdCcpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHJldHVybiBvZihjcmVhdGVBdXRoUmVzcG9uc2UodXNlcnNbMF0pKTsgLy8gUmV0dXJuIGFueSB2YWxpZCB1c2VyXG4gICAgICB9KTtcblxuICAgICAgLy8gQWN0IC0gQ29uY3VycmVudCByZXF1ZXN0cyB3aXRoIG1peCBvZiBjYWNoZSBoaXRzIGFuZCBtaXNzZXNcbiAgICAgIGNvbnN0IHByb21pc2VzID0gdG9rZW5zLmZsYXRNYXAodG9rZW4gPT4gXG4gICAgICAgIEFycmF5LmZyb20oeyBsZW5ndGg6IDQgfSwgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSB7IGhlYWRlcnM6IHsgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWAgfSB9O1xuICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSBjcmVhdGVNb2NrRXhlY3V0aW9uQ29udGV4dChyZXF1ZXN0KTtcbiAgICAgICAgICByZXR1cm4gYXV0aEd1YXJkLmNhbkFjdGl2YXRlKGNvbnRleHQpO1xuICAgICAgICB9KVxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0cy5ldmVyeShyZXN1bHQgPT4gcmVzdWx0ID09PSB0cnVlKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHRzKS50b0hhdmVMZW5ndGgoMjApOyAvLyA1IHRva2VucyDDlyA0IHJlcXVlc3RzIGVhY2hcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBURVNUUyBEJ0lOVMOJR1JBVElPTiAtIFLDiVNJTElFTkNFIFLDiVNFQVVcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGRlc2NyaWJlKCdOZXR3b3JrIFJlc2lsaWVuY2UgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbmV0d29yayB0aW1lb3V0cyB3aXRoIHJlYWwgSFRUUCBjbGllbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB0b2tlbiA9ICdleUpoYkdjaU9pSklVekkxTmlKOS50aW1lb3V0LXRlc3Quc2lnbmF0dXJlJztcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB7IGhlYWRlcnM6IHsgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWAgfSB9O1xuICAgICAgY29uc3QgY29udGV4dCA9IGNyZWF0ZU1vY2tFeGVjdXRpb25Db250ZXh0KHJlcXVlc3QpO1xuXG4gICAgICAvLyBNb2NrIGEgdGltZW91dCBlcnJvclxuICAgICAgamVzdC5zcHlPbihodHRwU2VydmljZSwgJ3Bvc3QnKS5tb2NrUmV0dXJuVmFsdWUoXG4gICAgICAgIHRocm93RXJyb3IoKCkgPT4gKHtcbiAgICAgICAgICBjb2RlOiAnRUNPTk5BQk9SVEVEJyxcbiAgICAgICAgICBtZXNzYWdlOiAndGltZW91dCBvZiA1MDAwbXMgZXhjZWVkZWQnLFxuICAgICAgICAgIG5hbWU6ICdFcnJvcicsXG4gICAgICAgIH0pKVxuICAgICAgKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoYXV0aEd1YXJkLmNhbkFjdGl2YXRlKGNvbnRleHQpKS5yZWplY3RzLnRvVGhyb3coSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBuZXR3b3JrIGNvbm5lY3Rpb24gZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdG9rZW4gPSAnZXlKaGJHY2lPaUpJVXpJMU5pSjkuY29ubmVjdGlvbi1lcnJvci5zaWduYXR1cmUnO1xuICAgICAgY29uc3QgcmVxdWVzdCA9IHsgaGVhZGVyczogeyBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW59YCB9IH07XG4gICAgICBjb25zdCBjb250ZXh0ID0gY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQocmVxdWVzdCk7XG5cbiAgICAgIC8vIE1vY2sgY29ubmVjdGlvbiBlcnJvclxuICAgICAgamVzdC5zcHlPbihodHRwU2VydmljZSwgJ3Bvc3QnKS5tb2NrUmV0dXJuVmFsdWUoXG4gICAgICAgIHRocm93RXJyb3IoKCkgPT4gKHtcbiAgICAgICAgICBjb2RlOiAnRUNPTk5SRUZVU0VEJyxcbiAgICAgICAgICBtZXNzYWdlOiAnY29ubmVjdCBFQ09OTlJFRlVTRUQgMTI3LjAuMC4xOjMwMDEnLFxuICAgICAgICAgIG5hbWU6ICdFcnJvcicsXG4gICAgICAgIH0pKVxuICAgICAgKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoYXV0aEd1YXJkLmNhbkFjdGl2YXRlKGNvbnRleHQpKS5yZWplY3RzLnRvVGhyb3coU2VydmljZVVuYXZhaWxhYmxlRXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEROUyByZXNvbHV0aW9uIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHRva2VuID0gJ2V5SmhiR2NpT2lKSVV6STFOaUo5LmRucy1lcnJvci5zaWduYXR1cmUnO1xuICAgICAgY29uc3QgcmVxdWVzdCA9IHsgaGVhZGVyczogeyBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW59YCB9IH07XG4gICAgICBjb25zdCBjb250ZXh0ID0gY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQocmVxdWVzdCk7XG5cbiAgICAgIC8vIE1vY2sgRE5TIGVycm9yXG4gICAgICBqZXN0LnNweU9uKGh0dHBTZXJ2aWNlLCAncG9zdCcpLm1vY2tSZXR1cm5WYWx1ZShcbiAgICAgICAgdGhyb3dFcnJvcigoKSA9PiAoe1xuICAgICAgICAgIGNvZGU6ICdFTk9URk9VTkQnLFxuICAgICAgICAgIG1lc3NhZ2U6ICdnZXRhZGRyaW5mbyBFTk9URk9VTkQgbm9uLWV4aXN0ZW50LWF1dGgtc2VydmljZS5sb2NhbCcsXG4gICAgICAgICAgbmFtZTogJ0Vycm9yJyxcbiAgICAgICAgfSkpXG4gICAgICApO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChhdXRoR3VhcmQuY2FuQWN0aXZhdGUoY29udGV4dCkpLnJlamVjdHMudG9UaHJvdyhTZXJ2aWNlVW5hdmFpbGFibGVFeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWNvdmVyIGFmdGVyIG5ldHdvcmsgaXNzdWVzIGFyZSByZXNvbHZlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHRva2VuID0gJ2V5SmhiR2NpT2lKSVV6STFOaUo5LnJlY292ZXJ5LXRlc3Quc2lnbmF0dXJlJztcbiAgICAgIGNvbnN0IHVzZXIgPSBjcmVhdGVUZXN0VXNlcigpO1xuICAgICAgY29uc3QgcmVxdWVzdCA9IHsgaGVhZGVyczogeyBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW59YCB9IH07XG4gICAgICBjb25zdCBjb250ZXh0ID0gY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQocmVxdWVzdCk7XG5cbiAgICAgIGNvbnN0IGh0dHBTcHkgPSBqZXN0LnNweU9uKGh0dHBTZXJ2aWNlLCAncG9zdCcpO1xuXG4gICAgICAvLyBGaXJzdCBjYWxsIGZhaWxzXG4gICAgICBodHRwU3B5Lm1vY2tSZXR1cm5WYWx1ZU9uY2UoXG4gICAgICAgIHRocm93RXJyb3IoKCkgPT4gbmV3IEVycm9yKCdOZXR3b3JrIGVycm9yJykpXG4gICAgICApO1xuXG4gICAgICAvLyBTZWNvbmQgY2FsbCBzdWNjZWVkc1xuICAgICAgaHR0cFNweS5tb2NrUmV0dXJuVmFsdWVPbmNlKG9mKGNyZWF0ZUF1dGhSZXNwb25zZSh1c2VyKSkpO1xuXG4gICAgICAvLyBBY3QgLSBGaXJzdCBjYWxsIHNob3VsZCBmYWlsXG4gICAgICBhd2FpdCBleHBlY3QoYXV0aEd1YXJkLmNhbkFjdGl2YXRlKGNvbnRleHQpKS5yZWplY3RzLnRvVGhyb3coSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbik7XG5cbiAgICAgIC8vIFNlY29uZCBjYWxsIHNob3VsZCBzdWNjZWVkXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhdXRoR3VhcmQuY2FuQWN0aXZhdGUoY29udGV4dCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdCgocmVxdWVzdCBhcyBhbnkpLnVzZXIpLnRvRXF1YWwodXNlcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gVEVTVFMgRCdJTlTDiUdSQVRJT04gLSBDQUNIRSBSRURJUyBSw4lFTFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgZGVzY3JpYmUoJ1JlYWwgUmVkaXMgQ2FjaGUgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBwZXJmb3JtIGFjdHVhbCBSZWRpcyBvcGVyYXRpb25zIGZvciBjYWNoZSBtYW5hZ2VtZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdG9rZW4gPSAnZXlKaGJHY2lPaUpJVXpJMU5pSjkucmVkaXMtdGVzdC5zaWduYXR1cmUnO1xuICAgICAgY29uc3QgdXNlciA9IGNyZWF0ZVRlc3RVc2VyKCk7XG4gICAgICBjb25zdCByZXF1ZXN0ID0geyBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbn1gIH0gfTtcbiAgICAgIGNvbnN0IGNvbnRleHQgPSBjcmVhdGVNb2NrRXhlY3V0aW9uQ29udGV4dChyZXF1ZXN0KTtcblxuICAgICAgamVzdC5zcHlPbihodHRwU2VydmljZSwgJ3Bvc3QnKS5tb2NrUmV0dXJuVmFsdWUob2YoY3JlYXRlQXV0aFJlc3BvbnNlKHVzZXIpKSk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgYXV0aEd1YXJkLmNhbkFjdGl2YXRlKGNvbnRleHQpO1xuXG4gICAgICAvLyBBc3NlcnQgLSBWZXJpZnkgUmVkaXMgb3BlcmF0aW9uc1xuICAgICAgYXdhaXQgd2FpdEZvckNhY2hlKCk7XG4gICAgICBjb25zdCBjYWNoZUtleSA9IGBhdXRoOnRva2VuOiR7cmVxdWlyZSgnY3J5cHRvJykuY3JlYXRlSGFzaCgnc2hhMjU2JykudXBkYXRlKHRva2VuKS5kaWdlc3QoJ2hleCcpfWA7XG4gICAgICBcbiAgICAgIC8vIENoZWNrIGRpcmVjdCBSZWRpcyBvcGVyYXRpb25zXG4gICAgICBjb25zdCBleGlzdHMgPSBhd2FpdCByZWRpc0NsaWVudC5leGlzdHMoY2FjaGVLZXkpO1xuICAgICAgZXhwZWN0KGV4aXN0cykudG9CZSgxKTtcblxuICAgICAgY29uc3QgY2FjaGVkVmFsdWUgPSBhd2FpdCByZWRpc0NsaWVudC5nZXQoY2FjaGVLZXkpO1xuICAgICAgZXhwZWN0KGNhY2hlZFZhbHVlKS5ub3QudG9CZU51bGwoKTtcbiAgICAgIGV4cGVjdChKU09OLnBhcnNlKGNhY2hlZFZhbHVlISkpLnRvRXF1YWwodXNlcik7XG5cbiAgICAgIGNvbnN0IHR0bCA9IGF3YWl0IHJlZGlzQ2xpZW50LnR0bChjYWNoZUtleSk7XG4gICAgICBleHBlY3QodHRsKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBSZWRpcyBjb25uZWN0aW9uIGZhaWx1cmVzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB0b2tlbiA9ICdleUpoYkdjaU9pSklVekkxTmlKOS5yZWRpcy1mYWlsdXJlLnNpZ25hdHVyZSc7XG4gICAgICBjb25zdCB1c2VyID0gY3JlYXRlVGVzdFVzZXIoKTtcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB7IGhlYWRlcnM6IHsgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWAgfSB9O1xuICAgICAgY29uc3QgY29udGV4dCA9IGNyZWF0ZU1vY2tFeGVjdXRpb25Db250ZXh0KHJlcXVlc3QpO1xuXG4gICAgICAvLyBTaW11bGF0ZSBSZWRpcyBmYWlsdXJlXG4gICAgICBqZXN0LnNweU9uKGNhY2hlU2VydmljZSwgJ2dldCcpLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignUmVkaXMgY29ubmVjdGlvbiBmYWlsZWQnKSk7XG4gICAgICBqZXN0LnNweU9uKGNhY2hlU2VydmljZSwgJ3NldCcpLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignUmVkaXMgY29ubmVjdGlvbiBmYWlsZWQnKSk7XG4gICAgICBqZXN0LnNweU9uKGh0dHBTZXJ2aWNlLCAncG9zdCcpLm1vY2tSZXR1cm5WYWx1ZShvZihjcmVhdGVBdXRoUmVzcG9uc2UodXNlcikpKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhdXRoR3VhcmQuY2FuQWN0aXZhdGUoY29udGV4dCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdCgocmVxdWVzdCBhcyBhbnkpLnVzZXIpLnRvRXF1YWwodXNlcik7XG4gICAgICAvLyBTaG91bGQgZmFsbGJhY2sgdG8gYXV0aCBzZXJ2aWNlIHdoZW4gY2FjaGUgZmFpbHNcbiAgICAgIGV4cGVjdChodHRwU2VydmljZS5wb3N0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjYWNoZSBrZXkgY29sbGlzaW9ucyBwcm9wZXJseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHRva2VuMSA9ICdleUpoYkdjaU9pSklVekkxTmlKOS5jb2xsaXNpb24tdGVzdC0xLnNpZ25hdHVyZSc7XG4gICAgICBjb25zdCB0b2tlbjIgPSAnZXlKaGJHY2lPaUpJVXpJMU5pSjkuY29sbGlzaW9uLXRlc3QtMi5zaWduYXR1cmUnO1xuICAgICAgXG4gICAgICBjb25zdCB1c2VyMSA9IHsgLi4uY3JlYXRlVGVzdFVzZXIoKSwgaWQ6ICd1c2VyLTEnIH07XG4gICAgICBjb25zdCB1c2VyMiA9IHsgLi4uY3JlYXRlVGVzdFVzZXIoKSwgaWQ6ICd1c2VyLTInIH07XG5cbiAgICAgIC8vIEFjdCAtIENhY2hlIGJvdGggdXNlcnNcbiAgICAgIGplc3Quc3B5T24oaHR0cFNlcnZpY2UsICdwb3N0JylcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2Uob2YoY3JlYXRlQXV0aFJlc3BvbnNlKHVzZXIxKSkpXG4gICAgICAgIC5tb2NrUmV0dXJuVmFsdWVPbmNlKG9mKGNyZWF0ZUF1dGhSZXNwb25zZSh1c2VyMikpKTtcblxuICAgICAgY29uc3QgcmVxdWVzdDEgPSB7IGhlYWRlcnM6IHsgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuMX1gIH0gfTtcbiAgICAgIGNvbnN0IGNvbnRleHQxID0gY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQocmVxdWVzdDEpO1xuICAgICAgYXdhaXQgYXV0aEd1YXJkLmNhbkFjdGl2YXRlKGNvbnRleHQxKTtcblxuICAgICAgY29uc3QgcmVxdWVzdDIgPSB7IGhlYWRlcnM6IHsgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuMn1gIH0gfTtcbiAgICAgIGNvbnN0IGNvbnRleHQyID0gY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQocmVxdWVzdDIpO1xuICAgICAgYXdhaXQgYXV0aEd1YXJkLmNhbkFjdGl2YXRlKGNvbnRleHQyKTtcblxuICAgICAgLy8gQXNzZXJ0IC0gVmVyaWZ5IGJvdGggdXNlcnMgYXJlIGNhY2hlZCBzZXBhcmF0ZWx5XG4gICAgICBhd2FpdCB3YWl0Rm9yQ2FjaGUoKTtcbiAgICAgIFxuICAgICAgY29uc3QgY2FjaGVLZXkxID0gYGF1dGg6dG9rZW46JHtyZXF1aXJlKCdjcnlwdG8nKS5jcmVhdGVIYXNoKCdzaGEyNTYnKS51cGRhdGUodG9rZW4xKS5kaWdlc3QoJ2hleCcpfWA7XG4gICAgICBjb25zdCBjYWNoZUtleTIgPSBgYXV0aDp0b2tlbjoke3JlcXVpcmUoJ2NyeXB0bycpLmNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZSh0b2tlbjIpLmRpZ2VzdCgnaGV4Jyl9YDtcblxuICAgICAgZXhwZWN0KGNhY2hlS2V5MSkubm90LnRvQmUoY2FjaGVLZXkyKTtcblxuICAgICAgY29uc3QgY2FjaGVkVXNlcjEgPSBhd2FpdCBjYWNoZVNlcnZpY2UuZ2V0KGNhY2hlS2V5MSk7XG4gICAgICBjb25zdCBjYWNoZWRVc2VyMiA9IGF3YWl0IGNhY2hlU2VydmljZS5nZXQoY2FjaGVLZXkyKTtcblxuICAgICAgZXhwZWN0KGNhY2hlZFVzZXIxKS50b0VxdWFsKHVzZXIxKTtcbiAgICAgIGV4cGVjdChjYWNoZWRVc2VyMikudG9FcXVhbCh1c2VyMik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjYWNoZSBldmljdGlvbiBhbmQgZXhwaXJhdGlvbiBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB0b2tlbiA9ICdleUpoYkdjaU9pSklVekkxTmlKOS5leHBpcmF0aW9uLXRlc3Quc2lnbmF0dXJlJztcbiAgICAgIGNvbnN0IHVzZXIgPSBjcmVhdGVUZXN0VXNlcigpO1xuXG4gICAgICAvLyBTZXQgd2l0aCB2ZXJ5IHNob3J0IFRUTFxuICAgICAgY29uc3QgY2FjaGVLZXkgPSBgYXV0aDp0b2tlbjoke3JlcXVpcmUoJ2NyeXB0bycpLmNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZSh0b2tlbikuZGlnZXN0KCdoZXgnKX1gO1xuICAgICAgYXdhaXQgY2FjaGVTZXJ2aWNlLnNldChjYWNoZUtleSwgdXNlciwgMSk7IC8vIDEgc2Vjb25kIFRUTFxuXG4gICAgICBjb25zdCByZXF1ZXN0ID0geyBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbn1gIH0gfTtcbiAgICAgIGNvbnN0IGNvbnRleHQgPSBjcmVhdGVNb2NrRXhlY3V0aW9uQ29udGV4dChyZXF1ZXN0KTtcblxuICAgICAgLy8gQWN0IC0gRmlyc3QgY2FsbCBzaG91bGQgaGl0IGNhY2hlXG4gICAgICBjb25zdCByZXN1bHQxID0gYXdhaXQgYXV0aEd1YXJkLmNhbkFjdGl2YXRlKGNvbnRleHQpO1xuICAgICAgZXhwZWN0KHJlc3VsdDEpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIGV4cGlyYXRpb25cbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMTAwKSk7XG5cbiAgICAgIC8vIFNldHVwIGF1dGggc2VydmljZSBmb3IgY2FjaGUgbWlzc1xuICAgICAgamVzdC5zcHlPbihodHRwU2VydmljZSwgJ3Bvc3QnKS5tb2NrUmV0dXJuVmFsdWUob2YoY3JlYXRlQXV0aFJlc3BvbnNlKHVzZXIpKSk7XG5cbiAgICAgIC8vIFNlY29uZCBjYWxsIHNob3VsZCBtaXNzIGNhY2hlIGFuZCBoaXQgYXV0aCBzZXJ2aWNlXG4gICAgICBjb25zdCByZXN1bHQyID0gYXdhaXQgYXV0aEd1YXJkLmNhbkFjdGl2YXRlKGNvbnRleHQpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQyKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGh0dHBTZXJ2aWNlLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBURVNUUyBEJ0lOVMOJR1JBVElPTiAtIE1PTklUT1JJTkcgRVQgT0JTRVJWQUJJTElUw4lcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGRlc2NyaWJlKCdNb25pdG9yaW5nIGFuZCBPYnNlcnZhYmlsaXR5IEludGVncmF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcHJvdmlkZSBtZXRyaWNzIGZvciBzdWNjZXNzZnVsIGF1dGhlbnRpY2F0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHRva2VuID0gJ2V5SmhiR2NpT2lKSVV6STFOaUo5Lm1ldHJpY3Mtc3VjY2Vzcy5zaWduYXR1cmUnO1xuICAgICAgY29uc3QgdXNlciA9IGNyZWF0ZVRlc3RVc2VyKCk7XG4gICAgICBjb25zdCByZXF1ZXN0ID0geyBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbn1gIH0gfTtcbiAgICAgIGNvbnN0IGNvbnRleHQgPSBjcmVhdGVNb2NrRXhlY3V0aW9uQ29udGV4dChyZXF1ZXN0KTtcblxuICAgICAgamVzdC5zcHlPbihodHRwU2VydmljZSwgJ3Bvc3QnKS5tb2NrUmV0dXJuVmFsdWUob2YoY3JlYXRlQXV0aFJlc3BvbnNlKHVzZXIpKSk7XG5cbiAgICAgIC8vIE1vY2sgbWV0cmljcyBjb2xsZWN0aW9uXG4gICAgICBjb25zdCBtZXRyaWNzQ29sbGVjdGVkOiBhbnlbXSA9IFtdO1xuICAgICAgY29uc3Qgb3JpZ2luYWxDb25zb2xlTG9nID0gY29uc29sZS5sb2c7XG4gICAgICBjb25zb2xlLmxvZyA9ICguLi5hcmdzKSA9PiB7XG4gICAgICAgIGlmIChhcmdzWzBdPy5pbmNsdWRlcyAmJiBhcmdzWzBdLmluY2x1ZGVzKCdBVVRIX1NVQ0NFU1MnKSkge1xuICAgICAgICAgIG1ldHJpY3NDb2xsZWN0ZWQucHVzaChhcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBvcmlnaW5hbENvbnNvbGVMb2coLi4uYXJncyk7XG4gICAgICB9O1xuXG4gICAgICB0cnkge1xuICAgICAgICAvLyBBY3RcbiAgICAgICAgYXdhaXQgYXV0aEd1YXJkLmNhbkFjdGl2YXRlKGNvbnRleHQpO1xuXG4gICAgICAgIC8vIEFzc2VydFxuICAgICAgICAvLyBJbiBhIHJlYWwgaW1wbGVtZW50YXRpb24sIHlvdSB3b3VsZCB2ZXJpZnkgbWV0cmljcyB3ZXJlIHNlbnQgdG8geW91ciBtb25pdG9yaW5nIHN5c3RlbVxuICAgICAgICBleHBlY3QoKHJlcXVlc3QgYXMgYW55KS51c2VyKS50b0VxdWFsKHVzZXIpO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgY29uc29sZS5sb2cgPSBvcmlnaW5hbENvbnNvbGVMb2c7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByb3ZpZGUgbWV0cmljcyBmb3IgYXV0aGVudGljYXRpb24gZmFpbHVyZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB0b2tlbiA9ICdleUpoYkdjaU9pSklVekkxTmlKOS5tZXRyaWNzLWZhaWx1cmUuc2lnbmF0dXJlJztcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB7IGhlYWRlcnM6IHsgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWAgfSB9O1xuICAgICAgY29uc3QgY29udGV4dCA9IGNyZWF0ZU1vY2tFeGVjdXRpb25Db250ZXh0KHJlcXVlc3QpO1xuXG4gICAgICBqZXN0LnNweU9uKGh0dHBTZXJ2aWNlLCAncG9zdCcpLm1vY2tSZXR1cm5WYWx1ZShcbiAgICAgICAgdGhyb3dFcnJvcigoKSA9PiBuZXcgQXhpb3NFcnJvcignVW5hdXRob3JpemVkJywgJzQwMScpKVxuICAgICAgKTtcblxuICAgICAgLy8gTW9jayBtZXRyaWNzIGNvbGxlY3Rpb25cbiAgICAgIGNvbnN0IG1ldHJpY3NDb2xsZWN0ZWQ6IGFueVtdID0gW107XG4gICAgICBjb25zdCBvcmlnaW5hbENvbnNvbGVFcnJvciA9IGNvbnNvbGUuZXJyb3I7XG4gICAgICBjb25zb2xlLmVycm9yID0gKC4uLmFyZ3MpID0+IHtcbiAgICAgICAgaWYgKGFyZ3NbMF0/LmluY2x1ZGVzICYmIGFyZ3NbMF0uaW5jbHVkZXMoJ0FVVEhfRkFJTFVSRScpKSB7XG4gICAgICAgICAgbWV0cmljc0NvbGxlY3RlZC5wdXNoKGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIG9yaWdpbmFsQ29uc29sZUVycm9yKC4uLmFyZ3MpO1xuICAgICAgfTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICAgIGF3YWl0IGV4cGVjdChhdXRoR3VhcmQuY2FuQWN0aXZhdGUoY29udGV4dCkpLnJlamVjdHMudG9UaHJvdyhJbnRlcm5hbFNlcnZlckVycm9yRXhjZXB0aW9uKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IgPSBvcmlnaW5hbENvbnNvbGVFcnJvcjtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdHJhY2sgY2FjaGUgaGl0L21pc3MgcmF0aW9zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgYmFzZVRva2VuID0gJ2V5SmhiR2NpT2lKSVV6STFOaUo5LmNhY2hlLW1ldHJpY3MnO1xuICAgICAgY29uc3QgdXNlciA9IGNyZWF0ZVRlc3RVc2VyKCk7XG5cbiAgICAgIC8vIFByZS1wb3B1bGF0ZSBjYWNoZSBmb3Igc29tZSB0b2tlbnNcbiAgICAgIGNvbnN0IGNhY2hlZFRva2VucyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDMgfSwgKF8sIGkpID0+IGAke2Jhc2VUb2tlbn0tY2FjaGVkLSR7aX0uc2lnbmF0dXJlYCk7XG4gICAgICBjb25zdCB1bmNhY2hlZFRva2VucyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDcgfSwgKF8sIGkpID0+IGAke2Jhc2VUb2tlbn0tdW5jYWNoZWQtJHtpfS5zaWduYXR1cmVgKTtcblxuICAgICAgZm9yIChjb25zdCB0b2tlbiBvZiBjYWNoZWRUb2tlbnMpIHtcbiAgICAgICAgY29uc3QgY2FjaGVLZXkgPSBgYXV0aDp0b2tlbjoke3JlcXVpcmUoJ2NyeXB0bycpLmNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZSh0b2tlbikuZGlnZXN0KCdoZXgnKX1gO1xuICAgICAgICBhd2FpdCBjYWNoZVNlcnZpY2Uuc2V0KGNhY2hlS2V5LCB1c2VyLCAzMDApO1xuICAgICAgfVxuXG4gICAgICBqZXN0LnNweU9uKGh0dHBTZXJ2aWNlLCAncG9zdCcpLm1vY2tSZXR1cm5WYWx1ZShvZihjcmVhdGVBdXRoUmVzcG9uc2UodXNlcikpKTtcblxuICAgICAgbGV0IGNhY2hlSGl0cyA9IDA7XG4gICAgICBsZXQgY2FjaGVNaXNzZXMgPSAwO1xuXG4gICAgICAvLyBBY3QgLSBUZXN0IGNhY2hlIGhpdHNcbiAgICAgIGZvciAoY29uc3QgdG9rZW4gb2YgY2FjaGVkVG9rZW5zKSB7XG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSB7IGhlYWRlcnM6IHsgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWAgfSB9O1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQocmVxdWVzdCk7XG4gICAgICAgIGF3YWl0IGF1dGhHdWFyZC5jYW5BY3RpdmF0ZShjb250ZXh0KTtcbiAgICAgICAgY2FjaGVIaXRzKys7XG4gICAgICB9XG5cbiAgICAgIC8vIFRlc3QgY2FjaGUgbWlzc2VzXG4gICAgICBmb3IgKGNvbnN0IHRva2VuIG9mIHVuY2FjaGVkVG9rZW5zKSB7XG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSB7IGhlYWRlcnM6IHsgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWAgfSB9O1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQocmVxdWVzdCk7XG4gICAgICAgIGF3YWl0IGF1dGhHdWFyZC5jYW5BY3RpdmF0ZShjb250ZXh0KTtcbiAgICAgICAgY2FjaGVNaXNzZXMrKztcbiAgICAgIH1cblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QoY2FjaGVIaXRzKS50b0JlKDMpO1xuICAgICAgZXhwZWN0KGNhY2hlTWlzc2VzKS50b0JlKDcpO1xuICAgICAgZXhwZWN0KGh0dHBTZXJ2aWNlLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcyg3KTsgLy8gT25seSBjYWNoZSBtaXNzZXMgY2FsbCBhdXRoIHNlcnZpY2VcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=